<?php
/**
 * @author Ondřej Doněk <ondrejd@gmail.com>
 * @link https://github.com/ondrejd/odwp-notices_generator for the canonical source repository
 * @license https://www.gnu.org/licenses/gpl-3.0.en.html GNU General Public License 3.0
 * @package odwp-notices_generator
 *
 * @todo Přidat `wpnonce`!
 * @todo Nahradit radio inputy v sekci "Pozůstalí" obrázky (ikonkami)!
 * @todo Umožnit náhled (a přidat pro to tlačítko dolů)!
 * @todo Umožnit uložit oznámení (nutnost registrace uživatele)!
 * @todo JavaScript nakonec přesunout do samostatného souboru!
 *
 * Parameters passed from {@see Notices_Generator_Plugin::shortcode_notice_designer_render}:
 *
 * @var array $borders Array with notice borders.
 * @var array $images  Array with notice images.
 * @var array $verses  Array with funeral verses.
 */

if ( ! defined( 'ABSPATH' ) ) {
    exit;
}
?>
<div class="notices-generator">
    <form action="" method="post" novalidate="novalidate">
        <fieldset id="notice-section-1">
            <legend><?php _e( 'Obrázek a verš', NG_SLUG ) ?></legend>
            <div class="notice-image">
                <div class="notice-image--inner"></div>
                <p class="description notice-image--desc"><?php _e( 'Vyberte si <a href="#">obrázek</a>', NG_SLUG ) ?></p>
            </div>
            <div class="notice-verse">
                <div class="inline-editor notice-verse--inner">
                    <p id="notice-verse-editor" contenteditable="true"><?php _e( "Kdo v naději žije, neumírá ...\n\n<em>F. Hrubín</em>", NG_SLUG ) ?></p>
                </div>
                <p class="description notice-verse--desc"><?php printf( __( 'Vyberte si %sjiný verš%s nebo napište vlastní', NG_SLUG ), '<span class="notice-verses-dlg-link">', '</span>' ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec2">
            <legend><?php _e( 'Text oznámení', NG_SLUG ) ?></legend>
            <div class="notice-text">
                <div class="inline-editor notice-text--inner">
                    <p id="notice-text-editor" contenteditable="true"><?php _e( "S bolestí v srdci oznamujeme všem příbuzným, přátelům a známým,\nže nás navždy opustil náš milovaný ...", NG_SLUG ) ?></p>
                </div>
                <p class="description notice-text--desc"><?php _e( 'Pokud chcete zvýraznit tučně pouze část textu, dejte před něj a za něj hvězdičku, např. <strong>*Váš*</strong> Pokud chcete text na nový řádek, stiskněte <em>ENTER</em>', NG_SLUG ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec3">
            <legend><?php _e( 'Jméno zesnulého', NG_SLUG ) ?></legend>
            <div class="notice-deceased">
                <div class="inline-editor notice-deceased--inner">
                    <p id="notice-deceased-editor" contenteditable="true"><?php _e( "Jan Novák", NG_SLUG ) ?></p>
                </div>
                <p class="description notice-thanks--desc"><?php _e( '', NG_SLUG ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec4">
            <legend><?php _e( 'Fotografie zesnulého', NG_SLUG ) ?></legend>
            <div class="notice-photo">
                <div class="notice-photo--inner">
                    <p><?php _e( 'Můžete nahrát <a href="#">fotografii zesnulého</a>', NG_SLUG ) ?></p>
                </div>
                <p class="description notice-photo--desc"><?php _e( '', NG_SLUG ) ?></p>
            </div>
            <p class="odwpng-todo"><code>TODO</code> Nahrát fotografii <small>(a rovnou zobrazit)</small>!</p>
        </fieldset>
        <fieldset id="odwpng-ngform_sec5">
            <legend><?php _e( 'Datum úmrtí', NG_SLUG ) ?></legend>
            <div class="notice-death_date">
                <div class="inline-editor notice-death_date--inner">
                    <p id="notice-death_date-editor" contenteditable="true"><?php _e( 'Zemřel tiše v sobotu 3. dubna 2011', NG_SLUG ) ?></p>
                </div>
                <p class="description notice-thanks--desc"><?php _e( '', NG_SLUG ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec6">
            <legend><?php _e( 'Místo posledního rozloučení', NG_SLUG ) ?></legend>
            <div class="notice-location">
                <div class="inline-editor notice-location--inner">
                    <p id="notice-location-editor" contenteditable="true"><?php _e( "S naším drahým zesnulým se naposledy rozloučíme v pátek 15. dubna 2011\nv malé obřadní síni krematoria v ...", NG_SLUG ) ?></p>
                </div>
                <p class="description notice-location--desc"><?php _e( '', NG_SLUG ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec7">
            <legend><?php _e( 'Jménem pozůstalých', NG_SLUG ) ?></legend>
            <div class="notice-survivors_text">
                <div class="inline-editor notice-survivors_text--inner">
                    <p id="notice-survivors_text-editor" contenteditable="true"><?php _e( 'Jménem pozůstalých', NG_SLUG ) ?></p>
                </div>
                <p class="description notice-survivors_text--desc"><?php _e( '', NG_SLUG ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec8">
            <legend><?php _e( 'Pozůstalí', NG_SLUG ) ?></legend>
            <div class="notice-survivors">
                <div class="notice-survivors--form">
                    <label><?php _e( 'Zobrazit jako: ', NG_SLUG ) ?></label>
                    <label class="notice-radio">
                        <input type="radio" name="ng-survivors-columns" value="1" checked="checked">
                        <?php _e( 'jeden sloupec', NG_SLUG ) ?>
                    </label>
                    <label class="notice-radio">
                        <input type="radio" name="ng-survivors-columns" value="2">
                        <?php _e( 'dva sloupce', NG_SLUG ) ?>
                    </label>
                    <label class="notice-radio">
                        <input type="radio" name="ng-survivors-columns" value="3">
                        <?php _e( 'tři sloupce', NG_SLUG ) ?>
                    </label>
                </div>
                <div class="inline-editor notice-survivors--inner">
                    <p id="notice-survivors-editor" contenteditable="true"><?php _e( "Dcera s rodinou, bratr s rodinou", NG_SLUG ) ?></p>
                </div>
                <p class="description notice-survivors--desc"><?php _e( 'Můžete napsat více jmen - oddělujte je čárkou. Jednotlivá jména pak budou zobrazena na samostatném řádku.', NG_SLUG ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec9">
            <legend><?php _e( 'Projevy a soustrasti', NG_SLUG ) ?></legend>
            <div class="notice-thanks">
                <div class="inline-editor notice-thanks--inner">
                    <p id="notice-thanks-editor" contenteditable="true"><?php _e( 'Za projevy soustrasti děkujeme', NG_SLUG ) ?></p>
                </div>
                <p class="description notice-thanks--desc"><?php _e( '', NG_SLUG ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec10">
            <legend><?php _e( 'Adresa', NG_SLUG ) ?></legend>
            <div class="notice-address">
                <div class="inline-editor notice-address--inner">
                    <p id="notice-address-editor" contenteditable="true"><?php _e( "Vaše adresa", NG_SLUG ) ?></p>
                </div>
                <p class="description notice-address--desc"><?php _e( '', NG_SLUG ) ?></p>
            </div>
        </fieldset>
        <fieldset id="odwpng-ngform_sec11">
            <legend><?php _e( 'Ostatní', NG_SLUG ) ?></legend>
            <p class="odwpng-todo"><code>TODO</code> Ohraničení oznámení!</p>
            <p class="odwpng-todo"><code>TODO</code> Pozadí oznámení!</p>
        </fieldset>
        <p class="buttons">
            <input type="submit" class="button-primary" value="<?php _e( 'Tisk', NG_SLUG ) ?>">
        </p>
    </form>
    <div id="notice-verses-dlg" class="dlg-container">
        <div class="dlg-header">
            <h3><?php _e( 'Vyberte smuteční verš', NG_SLUG ) ?></h3>
        </div>
        <div class="dlg-body">
            <ul class="verses-list">
                <?php foreach( $verses as $verse ) : ?>
                <li class="verses-item"><?php echo str_replace( "\n", ' ', $verse ) ?></li>
                <?php endforeach ?>
            </ul>
        </div>
        <div class="dlg-footer">
            <button class="button-cancel"><?php _e( 'Zrušit', NG_SLUG ) ?></button>
        </div>
    </div>
</div>
<script type="text/javascript">
jQuery( document ).ready( function() {
    // Open/hide functions for verses dialog
    var showVersesDlg = function() { jQuery( "#notice-verses-dlg" ).show(); };
    var hideVersesDlg = function() { jQuery( "#notice-verses-dlg" ).hide(); };
    // Corresponding event handlers:
    // 1) Open dialog
    jQuery( ".notice-verses-dlg-link" ).click( function( e ) { showVersesDlg(); } );
    // 2) Close dialog
    jQuery( "#notice-verses-dlg .button-cancel" ).click( function( e ) { hideVersesDlg(); } );
    // 3) Pick verse and close dialog
    jQuery( "#notice-verses-dlg .verses-list li" ).click( function( e ) {
        var verse = jQuery( this ).html();
        console.log( verse );
        jQuery( "#notice-verse-editor" ).html( verse );
        hideVersesDlg();
    } );
} );
</script>
